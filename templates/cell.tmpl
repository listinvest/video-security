{{define "cell"}}

<table cellspacing="0" style="width: 600px; height: 400px;">
	<tr>
		<th width="50px"></th>
		<th width="500px"></th>
		<th width="50px"></th>
	</tr>
	<tr>
		<td colspan="3" style="background:black;">
			<video id="video"
					src=""
					style="width: 600px; height: 380px;">
			</video>
	    </td>
	</tr>
	<tr>
		<td>
			URL:
		</td>
		<td>
			<input id="txtUrl"
					type="text"
					value="rtsp://admin:admin@192.168.11.178:554/cam/realmonitor?channel=1&subtype=1&unicast=true&proto=Onvif"
					style="width: 99%"/>
		</td>
		<td>
			<input id="btnOk"
					type="button"
					value="OK"
					onclick="OK(this)" />
		</td>
	</tr>
</table>	

<script>
	function OK(elmnt) {
		var table = elmnt.parentElement.parentElement.parentElement.parentElement
		txtUrl = table.querySelector('input[id=txtUrl]')
		video = table.querySelector('video[id=video]')

		// ? -> +
		url = txtUrl.value.replace("?", "%2B");
		// & -> $
		url = url.replace("&", "%24");

		var url = document.location.protocol + "//"
			+ document.location.host + "/v1/videostream"
			+ "?url=" + url;

		video.src = url;
		video.play();
	}
</script>

{{end}}